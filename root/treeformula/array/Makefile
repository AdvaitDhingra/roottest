# This is a template for all makefile.

#Set the list of files to be delete by clean:
CLEAN_TARGETS += filltree.output arrayDrawTest.output myTree.root $(ALL_LIBRARIES) *.log  NtpRecord.root

#Set the list of target to make while testing
TEST_TARGETS += multidim twodimvar arrayDrawTest arrayEventListTest boolOptTest indexMultiDimTest

# adjust the location of Rules.mk as needed.
ifeq ($(strip $(ROOTTEST_HOME)),)
	export ROOTTEST_HOME=$(shell expr $(PWD) : '\(.*/roottest/\)')
endif

include $(ROOTTEST_HOME)/scripts/Rules.mk


ifneq ($(FAIL),)
   #force re-execution in the fail case
	forceExec := $(shell rm -f arrayDrawTest.output)
endif

myTree.root: runFillTree.C fillTree.cxx Data.h Data.cxx 
	$(CMDECHO) root.exe -q -b -l runFillTree.C > filltree.output 2>&1

arrayDrawTest.output: runArrayTest.C myTree.root
	$(CMDECHO) root.exe -q -b -l runArrayTest.C > arrayDrawTest.output 2>&1 

arrayDrawTest: arrayDrawTest.output
ifeq ($(FAIL),)
	$(WarnFailTest)
endif
	$(CMDECHO) echo arrayDrawTest > /dev/null
	$(CMDECHO) diff -b arrayDrawTest.good arrayDrawTest.output

arrayEventListTest.log: eventlist.C
	$(CMDECHO) root.exe -b -l -q eventlist.C > arrayEventListTest.log 2>&1 

arrayEventListTest: arrayEventListTest.log
	$(CMDECHO) diff -b arrayEventListTest.ref arrayEventListTest.log

boolOptTest.log: boolOpt.C
	$(CMDECHO) root.exe -b -l -q boolOpt.C > boolOptTest.log 2>&1 

boolOptTest: boolOptTest.log
	$(CMDECHO) diff -b boolOptTest.ref boolOptTest.log

indexMultiDim.log: indexMultiDim.C orange.root
	$(CMDECHO) root.exe -b -l -q indexMultiDim.C > indexMultiDim.log 2>&1 || \
		diff -b indexMultiDim.ref indexMultiDim.log

indexMultiDimTest: indexMultiDim.log
	$(CMDECHO) diff -b indexMultiDim.ref indexMultiDim.log

testWithFailure:
ifeq ($(FAIL),)
	$(WarnFailTest)
endif

twodimvar.log: twodimvar_C.$(DllSuf)

twodimvar: twodimvar.log
	$(TestDiff)

multidim.log: NtpLib_C.$(DllSuf)

multidim: multidim.log
	$(TestDiff)
